@startuml
entity "Subject" as Subject {
    * subject_id : Integer
    * name : String
    * level : String
    * parent_subject : ForeignKey
    * description : Text
    * type : String
}

entity "Mentor" as Mentor {
    * mentor_id : Integer
    * name : String
    * title : String
    * photo : ImageField
    * bio : Text
    * email : EmailField
    * phone : String
    * subject_id : ForeignKey
}

entity "Applicant" as Applicant {
    * applicant_id : Integer
    * name : String
    * birth_date : DateField
    * id_card_number : String (Unique)
    * origin : String
    * undergraduate_major : String
    * email : EmailField
    * phone : String
    * undergraduate_school : String
    * school_type : String
    * resume : Text
}

entity "AdmissionCatalog" as AdmissionCatalog {
    * catalog_id : Integer
    * subject_id : ForeignKey
    * direction_id : Integer
    * total_quota : Integer
    * additional_quota : Integer
    * year : Integer
}

entity "MentorCatalogAssignment" as MentorCatalogAssignment {
    * assignment_id : Integer
    * catalog_id : ForeignKey
    * mentor_id : ForeignKey
    * year : Integer
    * has_admission_eligibility : Boolean
}

entity "ApplicantScore" as ApplicantScore {
    * score_id : Integer
    * applicant_id : ForeignKey
    * preliminary_score : Float
    * final_score : Float
}

entity "MentorApplicantPreference" as MentorApplicantPreference {
    * preference_id : Integer
    * applicant_id : ForeignKey
    * mentor_id : ForeignKey
    * preference_rank : Integer
    * status : Enum {Pending, Accepted, Rejected}
    * remarks : Text
}

entity "SystemRole" as SystemRole {
    * role_id : Integer
    * name : Enum {Student, Mentor, Admin} (Unique)
    * description : Text
}

entity "UserRole" as UserRole {
    * user_role_id : Integer
    * content_type : ContentType 
    * object_id : PositiveInteger
    * role_id : ForeignKey
}

entity "ContentType" as ContentType {
    * id : Integer
    * model : String
}

entity "SystemActivity" as SystemActivity {
    * activity_id : Integer
    * role_id : ForeignKey
    * activity : Text
}

Subject ||--|{ Mentor : "拥有"
Subject ||--|{ AdmissionCatalog : "确立"
AdmissionCatalog ||--|{ MentorCatalogAssignment : "分配"
Mentor ||--|{ MentorCatalogAssignment : "拥有"
Applicant ||--|{ ApplicantScore : "拥有"
Applicant ||--|{ MentorApplicantPreference : "确认"
Mentor ||--|{ MentorApplicantPreference : "确认"
SystemRole ||--|{ UserRole : "管理"
SystemRole ||--|{ SystemActivity : "关联"
ContentType ||--|{ UserRole : "帮助识别"
Applicant ||--|{ UserRole : "多态关联" 
Mentor ||--|{ UserRole : "多态关联" 
@enduml